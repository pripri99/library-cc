const db = require("./db");
const fs = require("fs");

async function downloadBookISBNs() {
  try {
    // Get all books from the "books" table
    const results = await db.query("SELECT isbn, title, author FROM books");
    const books = results.rows;

    // Get the ISBNs from the books
    const isbns = books.map((book) => book.isbn);

    // Save the ISBNs in a JSON file
    fs.writeFileSync("book_isbns.json", JSON.stringify(isbns));

    console.log(`Downloaded ${isbns.length} book ISBNs.`);

    // Log the title and author of each book
    for (const book of books) {
      console.log(`${book.title} by ${book.author}`);
    }
  } catch (err) {
    console.error("Failed to download book ISBNs:", err);
  }
}

downloadBookISBNs();
